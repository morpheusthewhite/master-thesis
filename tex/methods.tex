\chapter{Methods}
\label{ch:methods}

This chapter focuses on describing the main topic of the
research: the problems are motivated and defined in
\autoref{sec:the_echo_chamber_problem}, and their complexity is then analyzed
in \autoref{sec:problem_complexity_and_approximability}, while proposing some
alternative problem definitions. Algorithms and models for solving and
approximating the problems are then proposed in
\autoref{sec:solving_the_problem}; the definition of a generative model
concludes the chapter (\autoref{sec:generative_model}).

\section{The \acrlong{ECP}}%
\label{sec:the_echo_chamber_problem}

This section starts by outlining the graph on which the analysis is carried
out (\autoref{sub:interaction-graph}), the process for building it
(\autoref{sub:collection_and_preprocessing}) and finally defines the
\acrlong{ECP} and the \acrlong{D-ECP} (\autoref{sub:the_problem_definition} and
\autoref{sub:the_densest_echo_chamber_problem}).

\subsection{The Interaction Graph}
\label{sub:interaction-graph}

The \emph{Interaction Graph} $G$ is the graph which encodes the informations
regarding the interactions between the users.

In this graph each users is associated to a vertex $v \in V$ and each edge to
an interaction between the $2$ corresponding users it links. For this reason we
will sometime refer to vertices as users in the rest of the document.

$G = (V, E^{+}, E^{-})  $ is a
signed and weighted graph, the weights being in the interval $[-1, +1]$,
corresponding to positive and negative interactions, meaning that for smaller
the value of the weight the interaction will more "negative".

The \emph{Interaction Graph} is also directed, so that an edge from vertex $v_{i}
$ to vertex $v_{j} $ corresponds to a reply from user $v_{i} $ to $v_{j} $.

Let a content $C$ be any kind of resource that triggers a discussion in one or
more threads $T$. The set of threads associated to $C$ is denoted as
$\mathcal{T}_{C} $. A content is usually represented by a newspaper article and
it is identified by its url, e.g.

	{\footnotesize
		\begin{center}
			\url{https://www.nytimes.com/2021/03/04/us/richard-barnett-pelosi-tantrum.html}
		\end{center}
	}

A corresponding thread may then be, for example, a user posting and commenting
the same url on its Twitter account (see \autoref{fig:twitter-thread}), thus
generating a discussion.

\begin{figure}
	\centering
	\includegraphics[width=0.6\linewidth]{tex/img/twitter_thread.png}
	\caption[Thread-content distinction example from Twitter]{An thread associated to the mentioned New York Times article}%
	\label{fig:twitter-thread}
\end{figure}

The \emph{Interaction Graph} is a \emph{multiplex graph}, each layer being
represented by a thread $T$ whose edges are the interactions happening in it.
Note also that for this reason each of the layers can contain more than one
edge between $2$ users, as each pair of users can reply to each other more than
once.

We will also use $\mathcal{C} $ for denoting the set of contents.

An example of \emph{Interaction Graph} can be seen in
\autoref{fig:interaction-graph-example}.

\begin{figure}
	\begin{center}
		\begin{subfigure}[b]{0.3\textwidth}
			\centering
			\tikzfig{tex/tikz/graph_thread1}
			\caption{$T_{1} \in \mathcal{T}_{C_{1}} $}
			\label{fig:tex/tikz/graph_thread1.tikz}
		\end{subfigure}
		\begin{subfigure}[b]{0.3\textwidth}
			\centering
			\tikzfig{tex/tikz/graph_thread2}
			\caption{$T_{2} \in \mathcal{T}_{C_{1}} $}
			\label{fig:tex/tikz/graph_thread2.tikz}
		\end{subfigure}
		\begin{subfigure}[b]{0.3\textwidth}
			\centering
			\tikzfig{tex/tikz/graph_thread3}
			\caption{$T_{3} \in \mathcal{T}_{C_{2}} $}
			\label{fig:tex/tikz/graph_thread3.tikz}
		\end{subfigure}
	\end{center}
	\caption[Example \emph{Interaction Graph}]{An example of \emph{Interaction Graph}, green and red edges
		representing positive and negative interactions, respectively. It
		contains $3$ threads and $2$ contents, the first $2$ layers each being
		associated to a thread of content $C_{1} $, the last layer to a thread
		of content $C_{2} $}
	\label{fig:interaction-graph-example}
\end{figure}

\subsection{Collection and preprocessing}%
\label{sub:collection_and_preprocessing}

Datasets are built mainly upon $2$ social medias: Twitter and Reddit; the data
collection process, consequently, slightly differ between them.

\paragraph{Twitter}%
\label{par:twitter-data}

Twitter's \emph{Interaction Graphs} are mainly built starting from the tweets
of some important social accounts associated to well-known news source, like The
New York Times or Fox News, that tipically post links to their articles:
these profiles are taken as the source of the contents $\mathcal{C} $ of the graph.

Each time another user tweets the same url (\autoref{fig:twitter-thread}) then
it will correspond to another thread related to the same content, and all the
replies it receives will be part of this new thread.

Twitter data is retrieved with the help of Tweepy \cite{tweepy}, a Python
library for accessing the Twitter API, which has been patched for using some
features available only in the beta of the new Twitter API (v2).

\paragraph{Reddit}%
\label{par:reddit}

Differently from Twitter, Reddit focuses on subreddits, which are pages
collecting posts from different users about a specific topic (e.g. r/politics,
r/economics, $\dots$). This means that
in the datasets built from this social media the contents $\mathcal{C} $ is the
set of posts of these pages, which, differently from Twitter, most likely
come from different sources.

This posts are in turn crossposted, i.e. reposted on other subreddits. Each of
these \emph{crosspost} will eventually correspond to another thread.

The PRAW library is used for retrieving the data \cite{praw}.

\paragraph{Edge weights assignment}%
\label{par:assigning_edge_weights}

Once the threads interactions are retrieved they are passed to a state of the
art sentiment analyzer which labels them. More specifically the model used is
RoBERTa which has been adapted and retrained for dealing with Twitter
data \cite{Barbieri2020}. The model is made available by the Transformers
python library \cite{wolf-etal-2020-transformers}.

\bigskip

Finally, complying with the current privacy legislation, all the data related
to the user is pseudo-anonymized (accounts identifier are replaced by random
ones) while no data is publicly available.

\subsection{The problem definition}%
\label{sub:the_problem_definition}

The main goal of the research is finding echo chambers in social medias, more
specifically on the \emph{Interaction Graph} as defined in
\autoref{sub:interaction-graph}.

Our definition is based on the idea that echo chambers can be identified by
looking at contents which is generally highly debated (we will call
this type of content \emph{controversial}) but which is discussed with little
or no animosity in small subgraphs. This subgraphs are the \emph{Echo
	Chambers}.

\bigskip

Given an \emph{Interaction Graph} $G = (V, E^{+}, E^{-})$ on some contents
$\mathcal{C} $ and threads, let $\eta(T)$ the number of negative edges over the
total number of edges in the layer associated to thread $T$. Similarly,
let $\eta(C)$ be the fraction of negative edges in all threads associated to
content $C$.

\begin{definition}[Controversial thread]
	Let $\alpha \in [0,1]$. A thread (or content) is \emph{controversial} if
	$\eta(T) > \alpha$ (or, similarly, $\eta(C) > \alpha $). Conversely, a
	thread (or content) is \emph{non-controversial} if $\eta(T) \leq \alpha$
	($\eta(C) \leq \alpha$).
\end{definition}

Intutively, \emph{controversial} threads contain many negative
interactions. We denote as $\hat{\mathcal{C} } \subseteq \mathcal{C} $ the
set of \emph{controversial} contents.

\medskip

\emph{Echo Chambers} correspond to \emph{non-controversial} smaller subgraphs
(i.e. with few negative edges) discussing a
\emph{controversial} content.

More formally, let $T[U]$ the subgraph induced in the layer associated to
thread $T$ by the vertices $U$; let $|T^{+} [U]|$ and $|T^{-} [U]|$ its number
of positive and negative edges, respectively.

We define $\mathcal{S}_C (U)$ as the set of \emph{non-controversial} threads
induced by $U$, for \textit{controversial} contents, i.e.
	{\small
		\begin{equation}
			\mathcal{S} _{C} (U) = \{ T[U] \; s.t. \; T[U] \; non \;
			controversial, T \in \mathcal{T} _{C}, C
			\in \hat{\mathcal{C}}, U \subseteq V\}
		\end{equation}
	}

Thus $\mathcal{S} _C (U)$ will contain threads which are \emph{globally} non
controversial but it is defined only for contents that are \emph{globally}
controversial.

\medskip

We know define the Echo Chamber Score of a set of vertices $U$.

\begin{definition}[Echo Chamber Score]
	Let $U \subseteq V$ be a subset of vertices. Its Echo Chamber Score is

	\begin{equation}
		\label{eq:echo-chamber-score}
		\xi(U) = \sum^{}_{\mathcal{C} \in \mathcal{\hat{C}}} \sum^{}_{T[U] \in
		\mathcal{S} _{C} (U)} (|T^{+} [U]| - |T ^{-} [U]|)
	\end{equation}
\end{definition}

We can now define the \acrfull{ECP}.

\begin{problem}[\acrfull{ECP}]
Given an \emph{Interaction Graph} $G$ and $\alpha \in [0, 1]$ find a set of vertices $U \subseteq
	V$ maximizing the Echo Chamber Score (\autoref{eq:echo-chamber-score}).
\end{problem}

We will denote with $\hat{U}$ the set of users maximizing
\autoref{eq:echo-chamber-score} and with $\xi(G)$ its corresponding score, i.e.

\begin{align*}
	\hat{U} & \coloneqq \argmax_{U \subseteq V} \xi(U) & \xi(G) & \coloneqq
	\xi(\hat{U})
\end{align*}

\subsection{The Densest Echo Chamber Problem}%
\label{sub:the_densest_echo_chamber_problem}

The \acrshort{ECP} doesn't take into account the number of users producing a
certain score; this means that the set $U$ may involve disconnected and sparse
subgraphs, depending on the structure of the graph $G$.

For this reason it is interesting also to study another variant of the
\acrshort{ECP}, the \acrlong{D-ECP}, which we now define.

\begin{definition}[Echo Chamber Score]
	Let $U \subseteq V$ be a subset of vertices. Its Densest Echo Chamber Score is

	\begin{equation}
		\label{eq:densest-echo-chamber-score}
		\xi(U) = \sum^{}_{\mathcal{C} \in \mathcal{\hat{C}}} \sum^{}_{T[U] \in
		\mathcal{S} _{C} (U)} \frac{(|T^{+} [U]| - |T ^{-} [U]|)}{|U|}
	\end{equation}
\end{definition}

Similarly to the \acrshort{ECP} we can now define the corresponding problem

\begin{problem}[\acrfull{D-ECP}]
Given an \emph{Interaction Graph} $G$ and $\alpha \in [0, 1]$ find a set of vertices $U \subseteq
	V$ maximizing the Densest Echo Chamber Score (\autoref{eq:densest-echo-chamber-score}).
\end{problem}

\section{Problems complexity and approximability}%
\label{sec:problem_complexity_and_approximability}

We will now prove the inapproximability of the \acrshort{ECP} and
\acrshort{D-ECP} within some nontrivial factor.

\subsection{Hardness of \acrshort{ECP}}%
\label{sub:ecp-hardness}

\begin{theorem}
	\label{th:approximability}
	Echo Chamber Problem (ECP) has no $n^{1-\epsilon} $-approximation algorithm for
	any $\epsilon$ unless $\mathcal{P} = \mathcal{NP}  $
\end{theorem}

\begin{proof}
	We show this by presenting a direct reduction from \textsc{Maximum
		Independent Set} (MIS), which is known having the mentioned hardness
	factor (\autoref{tab:inapproximability-examples}).

	\bigskip
	Let $G_{1}  = (V_{1} ,E_{1} )$ be an undirected and unweighted graph and
	$\lambda > \frac{\alpha }{1 - \alpha }$, $\lambda \in \mathbb{N} $ and $n_{1} \coloneqq |V_{1}| $.
	We construct the \emph{Interaction Graph} ${G}_{2}  = (V_{2} , E^{+}_{2} , E
			^{-}_{2} ) $ as follows

	\begin{itemize}
		\item for each vertex $v_{i}  \in V_{1} $ we add a vertex in $G_{2} $
		\item for each edge $e_{ij}  \in
			      E_{1} $ we add $\lambda n_{1} $ negative edges between $v_{i} $ and $v_{j} $
		\item add a vertex $v_r$ and a positive edge between it and any other
		      vertex that we already inserted in $G_2$
		\item add a vertex $v_x$ and $\lambda n_{1} $ negative edges between $v_x$
		      and $v_{r} $
	\end{itemize}

	Furthermore, all the edges in $G_{2} $ are associated to the same content
	$C$ and the same thread $T \in \mathcal{T}_{C}  $.
	An illustration of the conversion can be found in \autoref{fig:construction}.

	\begin{figure}[b]
		\begin{center}
			\begin{subfigure}{0.4\textwidth}
				\centering
				\tikzfig{tex/tikz/approximability1}
				\vspace{10pt}
				\caption{$G_{1}$, undirected graph}
				\label{fig:g1_example}
			\end{subfigure}
			\begin{subfigure}{0.4\textwidth}
				\centering
				\tikzfig{tex/tikz/approximability2}
				\caption{$G_{2}$, directed signed graph, for $\lambda = 1$}
				\label{fig:g2_example}
			\end{subfigure}
		\end{center}
		\caption[Example reduction from MIP to \acrshort{ECP}]{Example construction of the interaction graph $G_{2} $ from
			$G_{1} $, for $\alpha = \frac{1}{2} $}
		\label{fig:construction}
	\end{figure}

	\begin{claim}
		\label{th:claim-controversial}
		Content $C$ is controversial.
	\end{claim}
	\begin{proof}
		Let $m_{2}^{-} $ and $m_{2}^{+} $ be the number of negative and
		positive edges in $G_2$, respectively.

		By construction $m_{2}^{+} = n_{1} $ and $m_{2}^{-} \geq \lambda n_{1}
		$. Also, for $a, b, c \in \mathbb{R}^{+}$ it holds that $\frac{a +
				b}{a + b + c} \geq \frac{a}{a + c} $. Consequently

		\begin{align}
			\eta(C) = \frac{m_{2}^{-} }{m_{2}^{-} +
				m_{2}^{+} } \geq \frac{\lambda n_{1}}{\lambda n_{1}
				+ n_{1} } = \frac{\lambda }{\lambda + 1} > \alpha
		\end{align}
	\end{proof}

	So content C is controversial. This reduces the Echo Chamber Problem on $G_2$ to the maximization of

	\begin{equation}
		\label{eq:score}
		\xi(U) = \sum^{}_{T \in S_{C}(U) } | T[U] |
	\end{equation}

	\begin{claim}
		\label{th:opt-equality}
		\begin{equation}
			OPT(ECP) = OPT(MIS)
		\end{equation}
	\end{claim}

	\begin{proof}
		Let $I \subseteq V_{1} $ be an independent set of $G_1$ of size $|I| >
			1$. Consider the associated solution in $G_2$ in which $U = I
			\cup \{v_{r} \}$. By construction it will contain $|I|$ positive
		edges, so $T$ will not be controversial and also

		\begin{equation}
			OPT(ECP) \geq \xi(U) = |T[U]| = |I| \implies OPT(ECP) \geq OPT(MIS)
		\end{equation}

		Now let $S \subseteq V_2$ be a solution of the Echo Chamber problem on
		$G_2$, and suppose $\xi(S) > 0$. It is easy to see that $v_{r} \in S$
		and that $v_{x} \not\in S $. Let $J \coloneqq S \setminus \{v_r\}$.

		Suppose that $2$ vertices $v_{i} $, $v_{j} \in J$ are linked in
		$G_1$. By construction there are at least $\lambda n_1$ negative edges
		in $T[S]$, thus

		\begin{equation}
			\eta(T[S]) \geq \frac{\lambda n_1}{\lambda n_1 + |S-1|} \geq \frac{\lambda n_1}{\lambda n_1 + n_1} = \frac{\lambda
			}{\lambda + 1} > \alpha
		\end{equation}

		This means that $T[S]$ is controversial $\implies \xi(S) = 0
			\implies contradiction$. Consequently $J$
		contains vertices which are independent in $G_1$. Therefore $T[S]$ contains
		only positive edges; more specifically

		\begin{equation}
			\xi(S) = |T[S]| = |S| - 1 = |S \setminus \{v_r\}| = |J|
		\end{equation}

		Thus

		\begin{equation}
			OPT(MIS) \geq |J| \implies OPT(MIS) \geq OPT(ECP)
		\end{equation}

		So the optimal value of the constructed instance of Echo Chamber Problem
		exactly equals that of the \textsc{Maximum Independent Set} instance, so it
		has an hardness factor at least as large as that of MIS.
	\end{proof}

	This concludes the proof of \autoref{th:approximability}.
\end{proof}

\subsection{Hardness of \acrshort{D-ECP}}%
\label{sub:d-ecp-hardness}

\begin{theorem}
	\label{th:approximability-densest}
	Densest Echo Chamber Problem (D-ECP) has no $n^{1-\epsilon} $-approximation algorithm for
	any $\epsilon$ unless $\mathcal{P} = \mathcal{NP}  $
\end{theorem}

\begin{proof}
	We again show this by presenting a direct reduction from \textsc{Maximum
		Independent Set}.

	\bigskip
	Let $G_{1}  = (V_{1} ,E_{1} )$ be an undirected and unweighted graph and
	$\lambda > \frac{\alpha }{1 - \alpha }$, $\lambda \in \mathbb{N} $ and $n_{1} \coloneqq |V_{1}| $.
	We construct the \emph{interaction} graph ${G}_{2}  = (V_{2} , E^{+}_{2} , E
			^{-}_{2} ) $ as follows

	\begin{itemize}
		\item for each vertex $v_{i}  \in V_{1} $ we add a vertex in $G_{2} $
		\item for each edge $e_{ij}  \in
			      E_{1} $ we add $\lambda (n_{1}+1)^{2}  $ negative edges between $v_{i} $ and $v_{j} $
		\item for each edge $e_{ij} \in V_1 \times V_1, e_{ij} \not\in
			      E_{1} $ we add $2$ positive edges between $v_{i} $ and $v_{j} $
		\item add a vertex $v_r$ and $2$ positive edges between it and any other
		      vertex that we already inserted in $G_2$
		\item add a vertex $v_x$ and $\lambda n_{1}^{2}  $ negative edges between $v_x$
		      and $v_{r} $
	\end{itemize}

	Furthermore, all the edges in $G_{2} $ are associated to the same content
	$C$ and the same thread $T \in \mathcal{T}_{C}  $.
	An illustration of the conversion can be found in
	\autoref{fig:construction-densest}.

	\begin{figure}
		\begin{center}
			\begin{subfigure}[b]{0.4\textwidth}
				\centering
				\tikzfig{tex/tikz/approximability1-densest}
				\vspace{30pt}
				\caption{$G_{1}$, undirected graph}
				\label{fig:g1_example}
			\end{subfigure}
			\begin{subfigure}[b]{0.4\textwidth}
				\centering
				\tikzfig{tex/tikz/approximability2-densest}
				\caption{$G_{2}$, directed signed graph}
				\label{fig:g2_example}
			\end{subfigure}
		\end{center}
		\caption[Example reduction from MIP to \acrshort{D-ECP}]{Example construction of the interaction graph $G_{2} $ from
			$G_{1} $}
		\label{fig:construction-densest}
	\end{figure}

	\begin{claim}
		\label{th:claim-controversial-densest}
		Content $C$ is controversial.
	\end{claim}
	\begin{proof}
		% Let $m_{2}^{-} $ and $m_{2}^{+} $ be the number of negative and
		% positive edges in $G_2$, respectively.
		%
		By construction $m_{2}^{+} \leq n_{1}^{2}  $ and $m_{2}^{-} \geq
			\lambda n_{1}^{2} $.
		Thus

		\begin{align}
			\eta(C) = \frac{m_{2}^{-} }{m_{2}^{-} +
				m_{2}^{+} } \geq \frac{\lambda n_{1} ^{2} }{\lambda n_{1}^{2}
				+ n_{1}^{2}  } = \frac{\lambda }{\lambda + 1}
			> \alpha
		\end{align}
	\end{proof}

	So content C is controversial. This reduces the Densest Echo Chamber Problem on $G_2$ to the maximization of

	\begin{equation}
		\label{eq:score-densest}
		\psi(U) = \sum^{}_{T \in S_{C}(U) } \frac{| T[U] |}{|U|}
	\end{equation}

	\begin{claim}
		\label{th:opt-equality-densest}
		\begin{equation}
			OPT(D-ECP) = OPT(MIS)
		\end{equation}
	\end{claim}

	\begin{proof}
		Let $I \subseteq V_{1} $ be an independent set of $G_1$ of size $n_{I}
			\coloneqq |I| > 1$. Consider the associated solution in $G_2$ in
		which $U = I \cup \{v_{r} \}$.

		By construction it will contain
		\begin{itemize}
			\item $2 \cdot n_{I} $ positive edges between $v_{r} $ and $v_{i} \in I$
			\item $n_{I}(n_{I}  -1)$
			      positive edges between vertices $v_{i} \in I$

		\end{itemize}
		$|I|$ positive
		thus $T$ will not be controversial and also

		\begin{equation}
			\label{eq:score-densest-mip}
			\psi(U) = \frac{|T[U]|}{|U|}  = \frac{2n_{I}  +
				\cdot n_{I}(n_{I}  -1) }{n_{I} + 1} = \frac{n_{I}^{2} +
				n_{I}}{n_{I} + 1} = n_{I}
		\end{equation}

		Consequently

		\begin{equation}
			OPT(D-ECP) \geq \psi(U) = |I| \implies OPT(D-ECP) \geq OPT(MIS)
		\end{equation}

		Now let $S \subseteq V_2$ be a solution of the Densest Echo Chamber
		problem on $G_2$, and suppose $\psi(S) > 0$. It is easy to see that
		$v_{r} \in S$ and that $v_{x} \not\in S $. Let $J \coloneqq S \setminus
			\{v_r\}$.

		Suppose that $2$ vertices $v_{i} $, $v_{j} \in J$ are linked in $G_1$.
		By construction there are at least $\lambda (n_1 + 1)^{2} $ negative edges in
		$T[S]$, thus

		\begin{equation}
			\eta(T[S]) \geq \frac{\lambda (n_1+1)^2}{\lambda (n_1+1)^2 + n(n+1)} \geq
			\frac{\lambda (n_1+1)^{2} }{\lambda (n_1+1)^2 + (n_1+1)^2} = \frac{\lambda }{\lambda +
				1} > \alpha
		\end{equation}

		This means that $T[S]$ is controversial $\implies \psi(S) = 0
			\implies contradiction$. Consequently $J$
		contains vertices which are independent in $G_1$. Therefore $T[S]$ contains
		only positive edges. As shown previously in
		\autoref{eq:score-densest-mip}

		\begin{equation}
			\psi(S) = \frac{|T[S]|}{|S|} = |J|
		\end{equation}

		Thus

		\begin{equation}
			OPT(MIS) \geq |J| \implies OPT(MIS) \geq OPT(D-ECP)
		\end{equation}

		So the optimal value of the constructed instance of Densest Echo Chamber Problem
		exactly equals that of the \textsc{Maximum Independent Set} instance, so it
		has an hardness factor at least as large as that of MIS.
	\end{proof}

	This concludes the proof of \autoref{th:approximability-densest}.
\end{proof}

\section{Solving the problem}%
\label{sec:solving_the_problem}

Now we present some techniques for calculating exactly and approximating both
the \acrshort{ECP} and the \acrshort{D-ECP}.

\subsection{A MIP model for the \acrshort{ECP}}%
\label{sub:a_mip_model_for_the_ecp}

Let $G$ be our \emph{Interaction Graph} for contents $\mathcal{C} $,
controversial contents $\mathcal{\hat{C}} \subseteq \mathcal{C} $ and
threads $T \in \mathcal{T}_{C}, \; C \in \mathcal{C} $. Let $E_k$ bet the set
of all edges of thread $T_k$ associated to a controversial content, i.e. $T_{k}
	\in \mathcal{T}_{C}, C \in \mathcal{\hat{C}}$; let also $E^{+}_k $
and $E^{-}_k $ be the set its positive and negative edges, respectively. Fix $\alpha \in [0, 1]$.

The following \acrshort{MIP} model is able to solve the \acrshort{ECP} on $G$
for values of $\alpha \leq 0.5$.

\begin{equation}
	\label{eq:ecp-exact1}
	\text{maximize} \; \sum_{ T_{k} \in \mathcal{T}_{C}, \; C \in
		\mathcal{\hat{C}} } \big( \sum^{}_{ij \in E^{+} (T_{k})} x_{ij}
		^{k} - \sum_{ij \in E^{-} (T_{k})} x_{ij} ^{k} \big)
\end{equation} \begin{center} subject to \end{center}
\begin{gather}
	\label{eq:ecp-v1}
	x _{ij}^{k}  \leq y_i \quad\quad \forall ij \in E_k  \\
	\label{eq:ecp-v2}
	x _{ij}^{k}  \leq y_j \quad\quad \forall ij \in E_k \\
	\label{eq:ecp-t1}
	x _{ij}^{k}  \leq z_k \quad\quad \forall ij \in E_k \\
	\label{eq:ecp-e1}
	x _{ij} ^{k} \geq - 2 + y_i + y_j + z_k \quad\quad \forall ij \in E_k \\
	\label{eq:ecp-alpha-constraint1}
	\sum^{}_{ij \in E_k^{-} } x_{ij}^{k}  - \alpha \sum^{}_{ij \in E_k}
	x_{ij} ^{k}  \leq 0 \quad\quad \forall T_{k} \in \mathcal{T} _{C}, C \in
	\hat{\mathcal{C}} \\
	\label{eq:ecp-vertex-def1}
	y _{i} \in  \{0, 1\} \quad\quad \forall i \in V \\
	\label{eq:ecp-edge-def1}
	0 \leq x _{ij} ^{k}  \leq 1 \quad\quad \forall ij \in E_k \\
	\label{eq:ecp-thread-def1}
	0 \leq z _{k} \leq 1 \quad\quad \forall T_{k} \in \mathcal{T} _{C}, C \in
	\hat{\mathcal{C}}
\end{gather}

The \acrshort{MIP} model introduces variables $x$, $y$ and $z$.
\begin{itemize}
	\item $y$ variables are associated to vertices
	      (\autoref{eq:ecp-vertex-def1}). Intutively $y_i = 1$ means that the
	      vertex $v_{i} $ is part of the set $U \subseteq V$ considered for the
	      score. Let $U \coloneqq \{ v_{i} \; s.t. \; y_{i} = 1, \;
		      v_{i} \in V \}$.
	\item $x$ variables are associated to edges (\autoref{eq:ecp-edge-def1}).
	      A value of $x_{ij}^{k} = 1$ should be interpreted as the fact that
	      the edge $e_{ij} \in E_k$ is contributing to the score,
	      i.e. $T_k \in \mathcal{S}_{C} (U)$.
	\item $z$ variables are associated to threads
	      (\autoref{eq:ecp-thread-def1}). A value of $1$ in this case
	      is associated to \emph{non-controversial} threads.
\end{itemize}

Let us consider Equations \ref{eq:ecp-v1}-\ref{eq:ecp-t1}. Due to them an
edge $e_{ij} \in E_k $ implies that
both vertices $v_{i} $ and $v_{j} $ are in $U$ and the thread is not controversial.

Viceversa \autoref{eq:ecp-e1} makes sure that, if both the incident vertices
are in $U$ and $z_{k} = 1$, then the edge contributes to the score.

Let us now consider a thread $T_k \in \mathcal{S}_{C} $.

Due to \autoref{eq:ecp-t1} and \autoref{eq:ecp-e1} all and only the edges
induced by $U$ have value $z_{k} $, i.e. $x_{ij}^{k} = z_k \; \forall v_{i}, v_{j}
	\in U$.

These variables will contribute to the objective function by

\begin{equation}
	\label{eq:ecp-thread-contribution}
	\sum^{}_{ij \in E^{+}_k } x_{ij} ^{k} - \sum_{ij \in E^{-} _k}
	x_{ij} ^{k} = \sum^{}_{ij \in E^{+} _k} z_k - \sum_{ij \in E^{-} _k}
	z_k = z_k (|E^{+} _k| - |E^{-} _k|)
\end{equation}

Let's suppose $T_k$ \emph{non-controversial}. Then by definition we have
$\eta(T_k) \leq \alpha $ and so

\begin{align}
	\eta(T_k)                                  & \leq \alpha        \\
	\frac{|E^{-} _k|}{|E^{-} _k| + |E^{+} _k|} & \leq \alpha        \\
	{|E^{-} _k|}                               & \leq \alpha(|E^{-}
	_k| + |E^{+} _k|)                                               \\
	\alpha {|E^{+} _k|}                        & \geq (1 -
	\alpha ) |E^{-} _k|                                             \\
	\frac{{|E^{+} _k|}}{|E^{-} _k|}
	                                           & \geq \frac{(1 -
		\alpha )}{\alpha } \geq 1
\end{align}

Where the last inequality holds since $\alpha \in [0, 0.5]$. So $|E^{+} _k| \geq
	|E^{-} _k|$. Thus the contribution of the thread will be maximized by
choosing $z_k = 1$ (\autoref{eq:ecp-thread-contribution}).
\autoref{eq:ecp-alpha-constraint1} can be easily seen to be satisfied since the
thread is \emph{non-controversial}.

Let us now suppose that $T_k \not\in \mathcal{S}_{C}(U)  $ . In this case setting $z_k$ to a value
different from $0$ will violate constraint~\ref{eq:ecp-alpha-constraint1}.

\bigskip

Let us now consider $\alpha \in (0.5, 1]$. With the current formulation if, for
a thread $T_k$, we have that $0.5 < \eta(T_k) \leq \alpha $ then the model will
prefer a solution in which all the edges $e_{ij} \in E_k$ are set to $0$, which
still satisfies all the constraints, even if the induced subgraph in the thread
is \emph{non-controversial} (and so contributes to the score and $x_{ij}^{k}  $
need to be set to 1). For this reason we need to introduce to the previous
problem the following constraints

\begin{gather}
	\label{eq:ecp-a-alpha-constraint}
	\sum^{}_{ij \in E^{-} (T_k)} a_{ij}^{k}  - \alpha \sum^{}_{ij \in E(T_k)}
	a_{ij} ^{k} \geq - N_{k} z_{k}  \quad\quad \forall T_{k} \in \mathcal{T} _{C}, C \in
	\hat{\mathcal{C}} \\
	\label{eq:ecp-a-ij-g-i-j}
	a_{ij}^{k} \geq -1 + y_i + y_j \quad\quad \forall ij \in E_k \\
	\label{eq:ecp-a-ij-l-i}
	a_{ij}^{k} \leq y_i\quad\quad \forall ij \in E_k \\
	\label{eq:ecp-a-ij-l-j}
	a_{ij}^{k} \leq y_j \quad\quad \forall ij \in E_k \\
	\label{eq:ecp-a-domain-2}
	0 \leq a_{ij}^{k} \leq 1 \quad\quad \forall ij \in E_k \\
	\label{eq:ecp-z-domain-2}
	0 \leq z _{k} \in  \{0, 1\} \quad\quad \forall T_{k} \in \mathcal{T} _{C}, C \in
	\hat{\mathcal{C}}
\end{gather}

Where \autoref{eq:ecp-z-domain-2} replaces \autoref{eq:ecp-thread-def1} and
$N_k \coloneqq \alpha |E^{+}_k| $ is a positive constant (its value correspond
to the minimum possible value achievable by the LHS to make the constraint as
tight as possible).

Variables $a_{ij}^{k}  $, associated to edges, are set to $1$ iff the
corresponding vertices are in $U$
(Equations~\ref{eq:ecp-a-ij-g-i-j}-\ref{eq:ecp-a-ij-l-j}). Consequently, if the
subgraph induced is not controversial then by definition the LHS of
\autoref{eq:ecp-a-alpha-constraint} will be smaller than $0$, forcing $z_k$ to
be 1, thus bounding the corresponding $x_{ij} ^{k} $ to be $1$ due to
\autoref{eq:ecp-e1}.


\subsection{A MIP model for the \acrshort{D-ECP}}%
\label{sub:a_mip_model_for_the_d_ecp}

Similarly to the \acrshort{ECP}, here we propose a \acrshort{MIP} model for
finding a solution for the \acrshort{D-ECP}, $\alpha \in [0, 0.5]$.

For simplifying notation we define $E_{k} \coloneqq E(T_{k}), T_{k} \in
	\mathcal{T}_{C}, C \in \mathcal{\hat{C}}$.

\begin{equation}
	\text{maximize} \; \sum_{ T_{k} \in \mathcal{T}_{C}, \; C \in
		\mathcal{\hat{C}} } \big( \sum^{}_{ij \in E^{+} (T_{k})} x_{ij}
		^{k} - \sum_{ij \in E^{-} (T_{k})} x_{ij} ^{k} \big)
\end{equation}
\begin{gather}
	\label{eq:d-ecp-a-ij-l-bi}
	a_{ij}^{k} \leq b_{i} \quad\quad \forall ij \in E_k \\
	\label{eq:d-ecp-a-ij-l-bj}
	a_{ij}^{k} \leq b_{j} \quad\quad \forall ij \in E_k \\
	\label{eq:d-ecp-a-ij-l-zk}
	a_{ij}^{k} \leq z_k  \quad\quad \forall ij \in E_k \\
	\label{eq:d-ecp-a-ij-g-ijk}
	a _{ij} ^{k} \geq - 2 + b_i + b_j + z_k \quad\quad \forall ij \in E_k \\
	\label{eq:d-ecp-alpha-constraint}
	\sum^{}_{ij \in E^{-} (T_k)} a_{ij}^{k}  - \alpha \sum^{}_{ij \in E(T_k)}
	a_{ij} ^{k}  \leq 0 \quad\quad \forall T_{k} \in \mathcal{T} _{C}, C \in
	\hat{\mathcal{C}} \\
	\label{eq:d-ecp-edge-charikar1}
	x _{ij}^{k}  \leq y_i \quad\quad \forall ij \in E_{k} \\
	\label{eq:d-ecp-edge-charikar2}
	x _{ij} ^{k} \leq y_j \quad\quad \forall ij \in E_k \\
	\label{eq:d-ecp-vertex-charikar1}
	\sum^{}_{i \in V} y_i \leq 1 \\
	\label{eq:d-ecp-}
	y_i \leq b_i \quad\quad \forall i \in V \\
	\label{eq:d-ecp-}
	y_i \geq -1 + b_i + y_j \quad\quad \forall i,j \in V \\
	\label{eq:d-ecp-}
	x_{ij}^{k} \geq -1 + a_{ij} ^{k} + y_i \quad \forall ij E_k \\
	\label{eq:d-ecp-}
	x_{ij}^{k} \geq -1 + a_{ij} ^{k} + y_j \quad \forall ij \in E_k \\
	\label{eq:d-ecp-}
	x_{ij} ^{k} \leq a_{ij} ^{k} \quad\quad \forall ij \in E_k \\
	\label{eq:d-ecp-a-ij}
	a _{ij} ^{k}  \in \{0, 1\} \quad\quad \forall ij \in E_k\\
	\label{eq:d-ecp-b-i}
	b _{i} \in \{0, 1\} \quad\quad \forall i \in V \\
	\label{eq:d-ecp-y-i}
	y _{i} \geq 0 \quad\quad \forall i \in V \\
	\label{eq:d-ecp-x-ij}
	x _{ij} ^{k}  \geq 0 \quad\quad \forall ij \in E_k\\
	\label{eq:d-ecp-z-k}
	0 \leq z _{k} \leq 1 \quad\quad \forall T_{k} \in \mathcal{T} _{C}, C \in
	\hat{\mathcal{C}}
\end{gather}

\begin{itemize}
	\item $y_i$ and $b_i$ variables are associated to vertices. $b_i$ are used
	      to identify nodes which are in $U$, similarly to
	      \autoref{sub:a_mip_model_for_the_ecp}. Thus we define $U \coloneqq \{ v_i
		      \; s.t. \; b_i = 1\}$.

	      $y_i$ variables, similarly to
	      \autoref{eq:charikar-model-densest-subgraph}, are needed for
	      computing the density value, the objective function,
	      by forcing the edges of the node $v_{i} $ to take a value lower that
	      $y_i$ (\autoref{eq:d-ecp-edge-charikar1} and
	      \autoref{eq:d-ecp-edge-charikar2}).
	\item $x_{ij}^{k}  $ and $a_{ij}^{k}  $ are associated to edges: the
	      first one will assume the value of the edge contribution to the score (in
	      our case $0$ or $1/|U|$) while the second is a binary variable taking
	      value $1$ if the edge is contributing to the score, $0$ otherwise.
	\item $z_k$ are the exact analogous of its homonym in
	      \autoref{sub:a_mip_model_for_the_ecp}.
\end{itemize}

In Equations~\ref{eq:d-ecp-a-ij-l-bi}-\ref{eq:d-ecp-alpha-constraint}
we can easily recognize the same constraints as in the \acrshort{ECP}, while in
Equations~\ref{eq:d-ecp-edge-charikar1}-\ref{eq:d-ecp-vertex-charikar1}
Charikar's model for solving the Densest Subgraph \cite{charikar2000greedy}.

\subsection{Approximation algorithms}%
\label{sub:approximation_algorithms}

We now present some approximation algorithms for solving the defined scores.
Let $\textsc{Score}_{\xi} (U)$ and $\textsc{Score}_{\psi} (U)$ be the functions computing the
\emph{Echo Chamber Score} and \emph{Densest-Echo Chamber Score} of $U$,
respectively. These subroutines iterate over the edges of the vertices in $U$,
ignoring those that are not induced by $U$, and counting for each thread $T \in
	\mathcal{T}_{C}, C \in \mathcal{\hat{C}} $ the number of edges and negative edges
to see which are \emph{controversial}, then calculating their contributions
(\autoref{alg:score_xi} shows in detail $\textsc{Score}_\xi$;
$\textsc{Score}_\psi$ can simply be computed as $\xi(U)/|U|$).

\begin{algorithm}
	\SetAlgoLined
	\KwResult{$\xi(U)$}
	$N^{+} (T) \leftarrow 0, \; N^{-} (T) \leftarrow 0\; \forall $ threads $T
		\in \mathcal{T}_{C}, C \in \mathcal{\hat{C}}   $ \;

	\ForEach{$v_{i} \in U$}{
		$S_i \leftarrow$ edges starting from $v_{i} $ \;
		\ForEach{$e_{ij} \in S_i$ \textbf{if} $v_{j} \in U$}{
			$T_{ij}  \leftarrow$ thread of $e_{ij} $ \;
			$w_{ij}  \leftarrow$ weight of $e_{ij} $ \;

			\uIf{$w_{ij} \geq 0$}{
				$N^{+}(T_{ij} ) \leftarrow N^{+}(T_{ij} ) + 1$ \;
			}\Else{
				$N^{-}(T_{ij} ) \leftarrow N^{-}(T_{ij} ) + 1$ \;
			}

		}
	}

	$\xi(U) \leftarrow 0$ \;
	$\eta(T) \leftarrow\frac{N^{-}(T)}{(N^{-}(T) + N^{+} (T))}$ \;
	\ForEach{$T\in \mathcal{T}_{C}, C \in \mathcal{\hat{C}}$ \textbf{if}
		$ \eta(T) \leq \alpha $}{
		$\xi(U) \leftarrow \xi(U) + N^{+}(T) - N^{-}(T)$
	}

	\caption{The $\textsc{Score}_{\xi}  $ subroutine}
	\label{alg:score_xi}
\end{algorithm}

\subsubsection{The $\beta$ algorithm}%
\label{ssub:the_beta_approach}

This algorithm (\autoref{alg:algorithm_beta}) construct a set of users $U$ by
iteratively adding the node which increases the score the most or removing from
$U$ the one which contributes the least, stopping when the score cannot be
increased by adding a node. Frequency of addition and removal are regulated
through $\beta $ (for smaller values an higher density is to be expected,
generally).

\begin{algorithm}
	\SetAlgoLined
	% \KwResult{Write here the result }
	$U = \{$ random node $\}$\;
	$\xi(U) = \textsc{Score}_{\xi}(U)$ \;
	\While{ $\exists \; v_{j} \; s.t. \; \textsc{Score}_{\xi} (U \bigcup \; \{
			v_{j} \} )> \xi(U)$}{
		$N(U) \leftarrow $ neighbours of vertices in $U$ in the graph $G$ \;
		With probability $\beta $\:  {
			$U \leftarrow U \bigcup \; \{ \arg\max_{v_{j} \in N(U)}
				\textsc{Score}_{\xi} (U \bigcup \;
				\{ v_{j} \}) \}$ \;
		}

		With probability $(1 - \beta )$ \: {
			$U \leftarrow U \setminus \{ \arg\max_{v_{j} \in U }
				\textsc{Score}_{\xi} (U \setminus \{ v_{j} \}) \}$ \;
		}

		% \uIf{1 is sampled from $Be(\beta )$}{
		%     $v = \arg\max_{v_{j} \in V \setminus U }
		%         \textsc{Score}_{\xi} (U \bigcup \;
		%         \{ v_{j} \}) $ \;
		%     $U \leftarrow U \bigcup \; \{ v \}$ \;
		% }\Else{
		%     $v =  \arg\max_{v_{j} \in U }
		%         \textsc{Score}_{\xi} (U \setminus \{ v_{j} \}) $ \;
		%     $U \leftarrow U \setminus \; \{ v \}$ \;
		% }
	}
	\caption{$\beta$ algorithm}
	\label{alg:algorithm_beta}
\end{algorithm}

In addition, one may also want to ignore a node when it is removed for the
next iterations, in order to avoid stucking the algorithm in repeatedly adding
and taking out from $U$ the same vertex.

The result is clearly dependant on the choice of the initial node: the process
should be repeated for different initial nodes; also, a variant
of the algorithm prefers starting from the vertices with the highest fraction of positive edges.

One of the limitations of this approach is that the algorithm will only find
sets of users that are connected in the original graph.

\subsubsection{Peeling algorithm}%
\label{ssub:peeling_algorithm}

Inspired to the greedy algorithm proposed in \cite{charikar2000greedy}, this
algorithms starts by considering as set of $U = V$, all the vertices,
iteratively removing the worst nodes (\autoref{alg:algorithm_peeling})

\begin{algorithm}
	\SetAlgoLined
	% \KwResult{Write here the result }
	$U = V$\;
	$S = \textsc{Score}_{\xi}(U)$ \;
	\While{$U \neq \emptyset$ }{
		$v = \arg\max_{v_{j} \in U }
			\textsc{Score}_{\xi} (U \setminus \{ v_{j} \})$ \;
		$U \leftarrow U \setminus \{ v \}$ \;

		$S = \max(S, \textsc{Score}_{\xi} (U)) $ \;
	}
	\Return $S$ \;

	\caption{Peeling algorithm}
	\label{alg:algorithm_peeling}
\end{algorithm}

In the case in some iterations the algorithm is unable to choose due to the
fact that one or more nodes produce the same score, then one of them is
randomly selected (or, alternatevily, the one which has the highest fraction of
negative edges).

\subsubsection{Rounding algorithm}%
\label{ssub:rounding_algorithm}

This algorithm reconstruct a solution starting from the results of the
relaxation of the exact models and is again inspired by the algorithm for
Reconstructing the exact solution from the \acrshort{LP} model in
\cite{charikar2000greedy}.

Let $r_{i}$ and $r_{ij} ^{k} $ be the value of $y_i$ and $x_{ij}^{k} $ in the
solution of the relaxation, respectively.

Let $\tilde{E}$ be the sequence of edges ordered in ascending order by $r_{ij}
		^{k} $. The algorithm (\autoref{alg:algorithm_rounding}) goes by iterating over
edges in $\tilde{E}$, adding them a \emph{dummy} graph $\hat{G}$, also eventually
adding incident nodes if not already present. At each iterations it is computed
the score of the vertices that were added to the graph $\hat{G}$ and the score
of the vertices of each component in the graph, keeping track of the best
result.

\begin{algorithm}
	\SetAlgoLined
	$\hat{G} = \leftarrow $ empty graph \;
	$\hat{V} \leftarrow $ vertices of $\hat{G}$ \;
	$S = 0$

	\ForEach{ $e_{ij}^{k} \in \tilde{E}$ }{
		$\hat{V} \leftarrow \hat{V} \bigcup \{ v_{i} \}$ \textbf{if} $v_i
			\not\in \hat{V}$ \;
		$\hat{V} \leftarrow \hat{V} \bigcup \{ v_{j} \}$ \textbf{if} $v_j
			\not\in \hat{V}$ \;

		$S \leftarrow \max(S, \; \textsc{Score}_{\xi}(\hat{V})  )$

		\ForEach{component $C$ in $\hat{G}$}{
			$S \leftarrow \max(S, \; \textsc{Score}_{\xi}(C)  )$
		}

	}

	\Return S \;
	\caption{Rounding algorithm}
	\label{alg:algorithm_rounding}
\end{algorithm}

The motivation for algorithm can be seen in
Figures~\ref{fig:rounding-original}-\ref{fig:rounding-relaxed}: the problem
relaxation involves a solution whose value assigned to the edges can be used to
find subgraphs with many positive edges by using each separate component as set
of users $U$.

\begin{figure}
	\begin{center}
		\begin{subfigure}[b]{0.4\textwidth}
			\centering
			\tikzfig{tex/tikz/rounding_original_t1}
			\caption{$T_1$}
			\label{fig:rounding-original-t1}
		\end{subfigure}
		\begin{subfigure}[b]{0.4\textwidth}
			\centering
			\tikzfig{tex/tikz/rounding_original_t2}
			\caption{$T_2$}
			\label{fig:rounding-original-t2}
		\end{subfigure}
	\end{center}
	\caption{Example original \emph{Interaction Graph} $G$}
	\label{fig:rounding-original}
\end{figure}
\begin{figure}
	\begin{center}
		\begin{subfigure}[b]{0.4\textwidth}
			\centering
			\tikzfig{tex/tikz/rounding_integer_t1}
			\caption{$T_1$}
			\label{fig:rounding-integer-t1}
		\end{subfigure}
		\begin{subfigure}[b]{0.4\textwidth}
			\centering
			\tikzfig{tex/tikz/rounding_integer_t2}
			\caption{$T_2$}
			\label{fig:rounding-original-t2}
		\end{subfigure}
	\end{center}
	\caption{Exact solution of the example in \autoref{fig:rounding-original},
		$\alpha = 0.4$}
	\label{fig:rounding-integer}
\end{figure}
\begin{figure}
	\begin{center}
		\begin{subfigure}[b]{0.4\textwidth}
			\centering
			\scalebox{0.8}{
				\tikzfig{tex/tikz/rounding_relaxed_t1}
			}
			\caption{$T_1$, where $z_1 = 0.66$}
			\label{fig:rounding-relaxed-t1}
		\end{subfigure}
		\begin{subfigure}[b]{0.4\textwidth}
			\centering
			\scalebox{0.8}{
				\tikzfig{tex/tikz/rounding_relaxed_t2}
			}
			\caption{$T_2$, where $z_2 = 1.0$}
			\label{fig:rounding-relaxed-t2}
		\end{subfigure}
	\end{center}
	\caption{Solution of the relaxation of $G$ of
		\autoref{fig:rounding-original}, $\alpha = 0.4$}
	\label{fig:rounding-relaxed}
\end{figure}

While one may think from these examples that the relaxation trivially assignes
non-zero values only to positive edges, \autoref{fig:rounding-original2} shows
a case in which a negative edge, $e_{31}$ gets the value of $1$; furthermore,
in this situation the algorithm is able to reconstruct the exact solution of the problem.

\begin{figure}
	\centering
	\tikzfig{tex/tikz/rounding_original2}
	\caption[Example of rounding algorithm finding the exact solution]{Another \emph{Interaction graph} example, with a single thread. In
		this case the rounding algorithm is able to find the exact solution by
		selecting all the nodes except for $v_4$. In the result of the
		relaxation all the edges except for $e_{42}$ get the value of $1$}%
	\label{fig:rounding-original2}
\end{figure}

\subsection{Solvable variants of the problem}%
\label{sub:solvable_variants_of_the_problem}

Due to the intrinsic complexity of the problems
(\autoref{sec:problem_complexity_and_approximability}) we define variants of
the problems, for some of which we are also able to find an exact solution.

For these new problems we need to define new graphs, obtained by preprocessing
the \emph{Interaction Graph}.

\subsubsection{The \acrlong{PA} Graph}%
\label{sub:pa-graph}

Let $G = (V, E^{+}, E^{-})$ be the \emph{interaction graph}, $\delta(v_{i}, v_{j})$ and
$\delta^{-} (v_{i}, v_{j})$ the sum of the edges and negative edges , respectively,
associated to controversial contents between vertices $v_{i} $ and $v_{j} $.

\bigskip

The \acrfull{PA} graph $G_P = (V_{P}, E_{P}) $ is constructed as follows from
$G$:

\begin{itemize}
	\item for any vertex $v_{i} \in V$ add a corresponding vertex in $V_{P} $
	\item for any pair of vertices $v_i, v_j$ in $G$ let $\eta(v_i,v_j)
		      \coloneqq \frac{\delta^{-} (v_i,v_j)}{\delta (v_i,v_j)} $. If
	      $\eta(v_i,v_j) \leq \alpha $ add a positive edge between $v_{i} $ and
	      $v_{j} $ in $G_{P} $ \footnotemark.
	      % \item don't add any edge otherwise between $v_{i} $ and $v_{j} $
\end{itemize}

\footnotetext{If, instead, $\eta(v_i,v_j) > \alpha $ or $\delta(v_{i}, v_{j}) =
		0$ then don't add any edge between the 2 vertices}



The problem then is finding the Densest Subgraph of $G_P$, i.e., if $E_{P} [U]$
is the set of edges induced on $G_P$ by $U \subseteq V$, finding $U$ maximizing

\begin{equation}
	\xi(U) = \frac{|E_{P} [U]|}{|U|}
\end{equation}

\subsubsection{The \acrlong{TPA} Graph}%
\label{ssub:the_tpa_graph}

Differently from the previous method, in this case edges are aggregated
separately for each thread.

\bigskip

More specifically, given an \emph{interaction graph} $G = (V, E^{+}, E^{-})$ ,
let $\delta_{T}(v_{i}, v_{j})$ and
$\delta^{-} _{T}(v_{i}, v_{j})$ the sum of the edges and negative edges , respectively,
associated to thread $T$ between vertices $v_{i} $ and $v_{j} $, being $T \in
	\mathcal{T}_{C}, C \in \mathcal{\hat{C}}$.

The construction of the \acrfull{TPA} Graph $G_{TP} = (V_{TP}, E_{TP})$ goes as follows

\begin{itemize}
	\item for any vertex $v_{i} \in V$ add a corresponding vertex in $V_{P} $
	\item for any thread $T \in
		      \mathcal{T}_{C}, C \in \mathcal{\hat{C}}$ and pair of vertices
	      $v_i, v_j$ in $G$ let $\eta_{T}(v_i,v_j)
		      \coloneqq \frac{\delta^{-} _{T}(v_i,v_j)}{\delta _{T}(v_i,v_j)} $. If
	      $\eta_{T}(v_i,v_j) \leq \alpha $ add a positive edge between $v_{i} $ and
	      $v_{j} $ in $G_{TP} $, in the layer associated to thread $T$.
	      % \item don't add any edge otherwise between $v_{i} $ and $v_{j} $
\end{itemize}

We can then solve on $G_{TP}$

\begin{enumerate}
	\item the Densest Subgraph Problem (or, equivalently, the
	      \acrshort{DCS}-MM)
	\item the \acrshort{O2BFF} Problem
\end{enumerate}

% \subsection{Validity of method}
% \todo[inline]{How will you know if your results are valid?}
